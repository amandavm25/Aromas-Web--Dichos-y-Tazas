@model AromasWeb.Abstracciones.ModeloUI.Asistencia

@{
    ViewBag.Title = "Editar Asistencia";
}

<!-- Hero Section -->
<section class="hero" style="min-height: 40vh; padding: 8rem 0 4rem;">
    <div class="hero-bg-overlay"></div>
    <div class="hero-leaves"></div>
    <div class="container hero-container" style="display: block;">
        <div class="hero-content" data-aos="fade-up" style="text-align: center;">
            <span class="hero-badge">
                <i class="fas fa-edit"></i>
                Actualizar Registro
            </span>
            <h1 class="hero-title" style="font-size: 3.5rem;">
                Editar
                <span class="hero-title-accent">Asistencia</span>
            </h1>
            <p class="hero-subtitle">
                Modifica el registro de asistencia
            </p>
        </div>
    </div>
    <div class="scroll-indicator">
        <div class="mouse">
            <div class="wheel"></div>
        </div>
    </div>
</section>

<!-- Formulario Section -->
<section class="admin-form-section">
    <div class="container" style="max-width: 80%;">
        @using (Html.BeginForm("EditarAsistencia", "Asistencia", FormMethod.Post))
        {
            @Html.AntiForgeryToken()
            @Html.HiddenFor(model => model.IdAsistencia)

            <div class="admin-form-wrapper" data-aos="fade-up">
                <form class="contact-form">
                    @Html.ValidationSummary(true, "Por favor, corrige los siguientes errores:", new { @class = "alert alert-danger" })

                    <!-- Información del Registro -->
                    <div class="admin-form-header">
                        <i class="fas fa-box"></i>
                        <h5>Información del Registro</h5>
                    </div>

                    <!-- Empleado -->
                    <div class="form-group">
                        <label>
                            <i class="fas fa-user"></i>
                            Empleado
                        </label>
                        @Html.DropDownListFor(model => model.IdEmpleado,
                        new SelectList(ViewBag.Empleados, "IdEmpleado", "NombreCompleto", Model.IdEmpleado),
                                        "Seleccione un empleado",
                                        new { @class = "form-control" })
                    @Html.ValidationMessageFor(model => model.IdEmpleado, "", new { @class = "text-danger" })
                </div>

                <!-- Fecha -->
                <div class="form-group">
                    <label>
                        <i class="fas fa-calendar-day"></i>
                        Fecha
                    </label>
                    @Html.EditorFor(model => model.Fecha, new { htmlAttributes = new { @class = "form-control", type = "date" } })
                    @Html.ValidationMessageFor(model => model.Fecha, "", new { @class = "text-danger" })
                </div>

                <!-- Información de Horario -->
                <div style="background: linear-gradient(135deg, var(--gold-bright) 0%, var(--gold) 100%); padding: 1rem 1.5rem; border-radius: 15px; margin: 2rem 0;">
                    <h5 style="color: white; margin: 0; display: flex; align-items: center; gap: 0.7rem;">
                        <i class="fas fa-clock"></i> Horario
                    </h5>
                </div>

                <!-- Hora de Entrada y Salida -->
                <div class="form-row">
                    <div class="form-group">
                        <label>
                            <i class="fas fa-sign-in-alt"></i>
                            Hora de Entrada
                        </label>
                        <input type="time" name="HoraEntrada" value="@Model.HoraEntrada.ToString(@"hh\:mm")" class="form-control" required />
                        @Html.ValidationMessageFor(model => model.HoraEntrada, "", new { @class = "text-danger" })
                    </div>

                    <div class="form-group">
                        <label>
                            <i class="fas fa-sign-out-alt"></i>
                            Hora de Salida
                        </label>
                        <input type="time" name="HoraSalida" value="@Model.HoraSalida?.ToString(@"hh\:mm")" class="form-control" />
                        @Html.ValidationMessageFor(model => model.HoraSalida, "", new { @class = "text-danger" })
                        <small class="admin-form-hint">
                            <i class="fas fa-info-circle"></i>
                            Dejar vacio si la jornada aún no ha finalizado
                        </small>
                    </div>
                </div>

                <!-- Tiempo de Almuerzo -->
                <div class="form-group">
                    <label>
                        <i class="fas fa-utensils"></i>
                        Tiempo de Almuerzo (minutos)
                    </label>
                    @Html.EditorFor(model => model.TiempoAlmuerzo, new { htmlAttributes = new { @class = "form-control", type = "number", min = "0", max = "120", placeholder = "Ej: 60" } })
                    @Html.ValidationMessageFor(model => model.TiempoAlmuerzo, "", new { @class = "text-danger" })
                    <small class="admin-form-hint">
                        <i class="fas fa-info-circle"></i>
                        Tiempo en minutos que el empleado tomó de almuerzo
                    </small>
                </div>

                <!-- Resumen de Horas (si hay salida registrada) -->
                @if (Model.HoraSalida.HasValue)
                    {
                        <div class="feature-card" style="margin: 2rem 0; padding: 1.5rem;">
                            <h6 style="color: var(--dark-green); margin-bottom: 1rem; font-weight: 700;">Resumen de Horas Trabajadas</h6>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
                                <div>
                                    <label style="color: var(--charcoal); opacity: 0.7; font-size: 0.85rem; font-weight: 600; text-transform: uppercase; display: flex; align-items: center; gap: 0.5rem;">
                                        <i class="fas fa-hourglass-half" style="color: var(--olive-green);"></i> Horas Totales
                                    </label>
                                    <p style="margin: 0.5rem 0 0; color: var(--dark-green); font-weight: 700; font-size: 1.2rem;">@Model.HorasTotales.ToString("F2")h</p>
                                </div>
                                <div>
                                    <label style="color: var(--charcoal); opacity: 0.7; font-size: 0.85rem; font-weight: 600; text-transform: uppercase; display: flex; align-items: center; gap: 0.5rem;">
                                        <i class="fas fa-clock" style="color: var(--olive-green);"></i> Regulares
                                    </label>
                                    <p style="margin: 0.5rem 0 0; color: var(--dark-green); font-weight: 700; font-size: 1.2rem;">@Model.HorasRegulares.ToString("F2")h</p>
                                </div>
                                <div>
                                    <label style="color: var(--charcoal); opacity: 0.7; font-size: 0.85rem; font-weight: 600; text-transform: uppercase; display: flex; align-items: center; gap: 0.5rem;">
                                        <i class="fas fa-star" style="color: var(--gold);"></i> Extras
                                    </label>
                                    <p style="margin: 0.5rem 0 0; color: var(--gold); font-weight: 700; font-size: 1.2rem;">@Model.HorasExtras.ToString("F2")h</p>
                                </div>
                            </div>
                        </div>
                    }

                    <!-- Información adicional -->
                    <div class="admin-form-info-box">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>Cálculo Automático</strong>
                            <p>Al guardar los cambios, el sistema recalculará automáticamente las horas trabajadas según los datos ingresados.</p>
                        </div>
                    </div>

                    
                    
                    <!-- Botones -->
                    <div class="admin-form-footer">
                        <button type="button" class="btn btn-secondary" onclick="window.location.href='@Url.Action("ListadoAsistencias", "Asistencia")'">
                            <i class="fas fa-times"></i>
                            <span> Cancelar </span>
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i>
                            <span> Guardar Cambios </span>
                        </button>
                    </div>
                </form>
            </div>
        }
    </div>
</section>

@section Scripts {
    <script src="~/js/asistencia.js"></script>
}